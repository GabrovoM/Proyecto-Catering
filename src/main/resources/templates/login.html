<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
	<meta charset="UTF-8">
	<meta name="description" content="Astur Catering - Ofrecemos una variedad de platos cuidadosamente preparados y listos para
						disfrutar en la comodidad de su hogar.">
	<meta name="keywords" content="catering, platos, menús, platos caseros">
	<title>Login</title>
	<link href="/webjars/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="/css/style.css">
	<link rel="icon" type="image/png" href="/img/favicon.png" sizes="64x64">
</head>
<body>
	<th:block th:insert="~{public/navigation::main-nav}"></th:block>
	<div class="container mt-4">
		<div class="row mt-5">
			<div class="col-2 col-md-3"></div>
			<div class="col-8 col-md-6 text-center">
				<h4 class="mb-3">Login</h4>
				<div th:if="${message}" class="alert alert-success d-flex justify-content-between align-items-center">
					<div>
						<i class="fas fa-check-circle"></i>
						<span th:text="${message}"></span>
					</div>
					<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
				</div>
				<div th:if="${error}" class="alert alert-danger d-flex justify-content-between align-items-center">
					<div>
						<i class="fas fa-exclamation-circle"></i>
						<span th:text="${error}"></span>
					</div>
					<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
				</div>
				<div th:if="${param.error}" id="login_error">
					Usuario o contraseña no válido.
				</div>
				<div th:if="${param.logout}">
					Has salido del sistema.
				</div>
				<form th:action="@{/j_spring_security_check}" method="post">
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
					<div class="d-flex flex-column flex-md-row align-items-center mb-3">
						<label for="username" class="mb-2 mb-md-0 me-md-2 text-center text-md-end"
							style="width: 120px;">Usuario:</label>
						<input type="text" name="username" id="username" class="form-control narrow-input" required/>
					</div>
					<div class="d-flex flex-column flex-md-row align-items-center mb-3">
						<label for="password" class="mb-2 mb-md-0 me-md-2 text-center text-md-end"
							style="width: 120px;">Contraseña:</label>
						<input type="password" name="password" id="password" class="form-control narrow-input" required/>
					</div>
					<div><input type="submit" value="Login" class="btn btn-sm btn-outline-success mt-4" /></div>
				</form>
				<form th:action="@{/logout}" method="POST" id="logoutForm"></form>
				<p class="mt-5">Si no tienes cuenta puedes registrarte <a th:href="@{/registrarse}">aquí.</a></p>
				<p><a th:href="@{/forgot_password}">¿Olvidó contraseña?</a></p>
				<p><a href="/">Ir al inicio</a></p>
			</div>
			<div class="col-8 col-md-3"></div>
		</div>
	</div>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
		integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
		crossorigin="anonymous"></script>
	<script src="/webjars/jquery/jquery.min.js"></script>
	<script src="/webjars/bootstrap/js/bootstrap.min.js"></script>
	<script>
		const usernameInput = document.getElementById('username');
		const passwordInput = document.getElementById('password');
		const errorMessage = document.getElementById('login_error');
		usernameInput.addEventListener('input', () => {
			if (errorMessage) {
				errorMessage.style.display = 'none';
			}
		});
		passwordInput.addEventListener('input', () => {
			if (errorMessage) {
				errorMessage.style.display = 'none';
			}
		});
	</script>
</body>
</html>